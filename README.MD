# üïí Routine Manager Service

Um motor de execu√ß√£o de rotinas robusto que transforma scripts em servi√ßos resilientes do Windows. O sistema monitora agendamentos em banco de dados, gerencia execu√ß√µes concorrentes via Threads e automatiza o report de resultados por e-mail.

## üöÄ Funcionalidades

* **Servi√ßo Windows:** Execu√ß√£o cont√≠nua em segundo plano via NSSM.
* **Multithreading:** Processamento paralelo de rotinas para evitar gargalos.
* **Tipos de Rotina:** Suporte nativo para:
* üìä **Relat√≥rios:** Gera√ß√£o e envio de dados.
* üîî **Informativos:** Alertas e comunica√ß√µes.
* ‚ö° **Triggers:** Disparos de eventos em outros sistemas.


* **Notifica√ß√£o Autom√°tica:** Sistema de mailing integrado p√≥s-execu√ß√£o.

## üõ†Ô∏è Arquitetura do Banco de Dados

O servi√ßo baseia-se em duas tabelas principais:

1. **`cadastro_rotinas`**: Cont√©m o nome, tipo, comando de execu√ß√£o, status (ativo/inativo) e o cronograma/trigger.
2. **`email_rotinas`**: Lista de destinat√°rios vinculados a cada rotina.

## ‚öôÔ∏è Como Funciona

O fluxo de opera√ß√£o segue o ciclo abaixo:

1. **Polling:** O servi√ßo consulta a tabela `cadastro_rotinas` em intervalos definidos.
2. **Verifica√ß√£o:** Filtra rotinas ativas cuja hora de execu√ß√£o coincide com o `now()`.
3. **Processamento:** Para cada rotina encontrada, o sistema abre uma **Thread dedicada**. Isso permite que um relat√≥rio pesado n√£o atrase um informativo simples.
4. **Conclus√£o:** Ap√≥s o t√©rmino da tarefa, o servi√ßo busca os contatos na `email_rotinas` e dispara o log/status da opera√ß√£o.

## üíª Instala√ß√£o e Configura√ß√£o

### Pr√©-requisitos

* [NSSM (Non-Sucking Service Manager)](https://nssm.cc/)
* Banco de Dados (Configurar string de conex√£o no `.env`)

### Passos para Instala√ß√£o

1. **Clone o reposit√≥rio:**
```bash
git clone https://github.com/PedroRdrigues/cadastro_rotinas.git

```


2. **Configure as vari√°veis de ambiente:**
Crie um arquivo `.env` na raiz seguindo o modelo `.env.example`.
3. **Instale como Servi√ßo Windows:**
Abra o terminal como Administrador e utilize o NSSM:
```bash
nssm install RotinasService
nssm edit RotinasService
nssm start RotinasService

```



## üìä Estrutura de Tipos

| Tipo | Descri√ß√£o                                                | A√ß√£o P√≥s-Execu√ß√£o                |
| --- |----------------------------------------------------------|----------------------------------|
| **Relat√≥rio** | Cria√ß√£o de relat√≥rios em Excel a partir de consultas sql | Envio de anexo via E-mail        |
| **Informativo** | Verifica√ß√£o de status simples                            | Envio de anexos/corpo via E-mail |
| **Trigger** | Execu√ß√£o de Procedure ou script externo                  | Confirma√ß√£o de disparo           |

---

**Desenvolvido por [Pedro Rodrigues]**
*Conecte-se comigo no [LinkedIn*](www.linkedin.com/in/pedrordrigues)
